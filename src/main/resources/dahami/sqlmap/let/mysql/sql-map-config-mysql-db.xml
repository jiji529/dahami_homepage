<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tre_ATCdb">

	<typeAlias alias="boardVO" type="com.dahami.api.main.service.vo.BoardVO" />
	<typeAlias alias="instaTokenVO" type="com.dahami.api.main.service.vo.InstaTokenVO" />
	
	<resultMap id="NoticeLstMap" class="com.dahami.api.main.service.vo.BoardVO">
		<result property="Uid" 			column="f_uid" />
		<result property="Gid" 			column="f_gid" />
		<result property="Hit" 			column="f_hit" />
		<result property="Title" 		column="f_title" />
		<result property="Body" 		column="f_body" />
		<result property="State" 		column="f_state" />
		<result property="File1" 		column="f_file1" />
		<result property="File2" 		column="f_file2" />
		<result property="Regdate"		column="f_regdate" />
	</resultMap>
	
	<resultMap id="QnaLstMap" class="com.dahami.api.main.service.vo.BoardVO">
		<result property="seq" 			column="seq" />
		<result property="gubun" 		column="gubun" />
		<result property="quest" 		column="quest" />
		<result property="answer" 		column="answer" />
	</resultMap>
	
	<resultMap id="LogoLstMap" class="com.dahami.api.main.service.vo.LogoVO">
		<result property="mediaName"      column="media_name" />
		<result property="mediaCode"      column="media_code" />
		<result property="kindName"       column="kind_name" />
		<result property="kindSerial"     column="kind_serial" />
		<result property="mediaDelegated"   column="media_delegated" />
		<result property="mediaTrusted"   column="media_trusted" />
		<result property="mediaUntrusted" column="media_untrusted" />
		<result property="mediaOnline"    column="media_online" />
		<result property="fileName"       column="file_name" />
	</resultMap>
	
	<resultMap id="InstaTokenMap" class="com.dahami.api.main.service.vo.InstaTokenVO">
		<result property="seq" 			column="seq" />
		<result property="userId" 		column="userId" />
		<result property="token" 		column="token" />
		<result property="expire" 		column="expire" />
		<result property="regdate" 		column="regdate" />
	</resultMap>
	
	<select id="NoticeLst" parameterClass="boardVO" resultMap="NoticeLstMap">
		SELECT
			f_uid,
			f_gid,
			f_hit,
			f_title,
			f_body,
			f_state,
			f_file1,
			f_file2,
			f_regdate
		FROM
			dahami_board.tbl_news
		WHERE
			f_state = 1
		<isNotEmpty prepend="and" property="Title" >
			f_title LIKE "%$Title$%" or f_body LIKE "%$Title$%"
		</isNotEmpty>
		ORDER BY f_uid desc
		LIMIT #stPageSize# , #endPageSize#
	</select>
	
	<select id="NoticeCnt" parameterClass="boardVO" resultClass="Integer">
		SELECT
			count(f_uid)as cnt
		FROM
			dahami_board.tbl_news
		WHERE
			f_state = 1
		<isNotEmpty prepend="and" property="Title" >
			f_title LIKE "%$Title$%" or f_body LIKE "%$Title$%"
		</isNotEmpty>
		ORDER BY f_uid desc
	</select>
	
	<select id="FaqLst" parameterClass="boardVO" resultMap="QnaLstMap">
		SELECT
			seq,
			gubun,
			quest,
			answer
		FROM
			new_scrapmaster.qna
		WHERE
			gubun='서비스/계약/저작권'
		<isNotEmpty prepend="and" property="question" >
			(quest LIKE "%$question$%" or answer LIKE "%$question$%")
		</isNotEmpty>
		ORDER BY seq desc
		LIMIT #stPageSize# , #endPageSize#
	</select>
	
	<select id="FaqCnt" parameterClass="boardVO" resultClass="Integer">
		SELECT
			count(seq)as cnt
		FROM
			new_scrapmaster.qna
		WHERE
			gubun='서비스/계약/저작권'
		<isNotEmpty prepend="and" property="question" >
			(quest LIKE "%$question$%" or answer LIKE "%$question$%")
		</isNotEmpty>
		ORDER BY seq desc
	</select>	
	
	<select id="LogoLst" resultMap="LogoLstMap">
		SELECT
			media_name,
			media_code,
			kind_name,
			kind_serial,
			media_delegated,
			media_trusted,
			media_untrusted,
			media_online,
			file_name
		FROM
			new_scrapmaster.logo
		WHERE
			display = 'Y'
		ORDER BY
			kind_serial, media_name
	</select>
	
	<select id="InstaTokenData" resultMap="InstaTokenMap">
		SELECT 
			seq,userId,token,expire,regdate
		FROM 
			dahami_board.instaToken
		ORDER BY 
			seq DESC
		LIMIT 1
	</select>
	
	<insert id="insertNewToken" parameterClass="instaTokenVO">
		INSERT INTO dahami_board.instaToken
		(userId,token,expires_in,expire,regdate)
		VALUES
		(#userId#,#token#,#expires_in#,#expire#,NOW())
	</insert>
</sqlMap>